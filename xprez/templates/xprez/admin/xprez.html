{% load i18n %}
{% load xprez_admin %}

<div class="xprez" data-component="xprez" data-defaults="{{ form.xprez_admin.xprez_defaults_json }}">
    <div class="xprez-top">
        <div class="xprez-option" data-active="true" data-text-label="true">
            <label for="view">
                <i class="xprez-icon-view"></i>
                <span>View</span>
            </label>
            <span class="xprez-option__dropdown">
                <select class="xprez-option__select" id="view" data-component="xprez-view-select">
                    <option value="sm">Default edit view</option>
                    {% for id, data in form.xprez_admin.xprez_breakpoints.items %}
                        <option value="{{ id }}">{{ data.name|safe }}</option>
                    {% endfor %}
                </select>
            </span>
        </div>

        <span class="xprez-btn xprez-btn-transparent xprez-btn--sm" data-component="xprez-all-sections-collapser">
            <i class="xprez-icon-vertical"></i>
            Collapse all
        </span>
        <span class="xprez-btn xprez-btn-transparent xprez-btn--sm {# success #}">
            <span class="xprez-btn__inner xprez-btn__success">
                {% include "xprez/admin/icons/checkmark.html" %}
                Copied
            </span>
            <span class="xprez-btn__inner xprez-btn__default">
                <i class="xprez-icon-copy"></i>
                Copy all
            </span>
        </span>
    </div>

    <div data-component="xprez-sections-container">
        {% for section in form.xprez_sections %}
            {% xprez_section_render_admin section %}
        {% endfor %}
    </div>

    {% comment %} {% include "./dev/section.html" %} {% endcomment %}

    {% with available_modules=form.xprez_get_available_modules %}
        {% if available_modules %}
            <div class="xprez-add-after">
                <div class="xprez-section__header--centered">
                    <h3>Add section</h3>
                </div>
                {% include "./includes/add_list.html" with component_name="xprez-adder-container-end" xprez_admin=form.xprez_admin add_list_container=form.instance %}
            </div>
        {% endif %}
    {% endwith %}
</div>

<script>
    window.addEventListener("DOMContentLoaded", function() {
        window.xprez = new Xprez();
    });
</script>
